# resoto-cf
Resoto IAM Role Cloudformation Templates

## Overview

These templates are used to create an AWS IAM role that has the exact permissions Resoto requires to run. The role template is autogenerated whenever the AWS plugin is updated.

The best starting point is our [How to Roll Out Resoto AWS Permissions with CloudFormation](https://resoto.com/docs/how-to-guides/configuration/roll-out-resoto-aws-permissions-with-cloudformation) how to guide.

If you are only interested in the S3 URIs, here they are:
[https://resotopublic.s3.amazonaws.com/cf/resoto-role.template](https://resotopublic.s3.amazonaws.com/cf/resoto-role.template)
[https://resotopublic.s3.amazonaws.com/cf/resoto-stackset.template](https://resotopublic.s3.amazonaws.com/cf/resoto-stackset.template)

The code that generates the role as well as the role template, lives in [the AWS Resoto plugin project](https://github.com/someengineering/resoto/tree/main/plugins/aws/tools/awspolicygen).

## Usage

For details we recommend reading the how-to linked above, but the TL;DR is:

```bash
AWS_OU="r-7h7x"  # Replace with your OU
RESOTO_ACCOUNT_ID="434236089377"  # Replace with your Resoto account ID
aws cloudformation create-stack \
  --region us-east-1 \
  --stack-name ResotoAccess \
  --template-url https://resotopublic.s3.amazonaws.com/cf/resoto-stackset.template \
  --parameters ParameterKey=DeploymentTargetOrganizationalUnitIds,ParameterValue="$AWS_OU" ParameterKey=ResotoAccountID,ParameterValue=$RESOTO_ACCOUNT_ID
```
